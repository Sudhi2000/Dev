<div class="container-fluid">
    <div class="row" [formGroup]="Form">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-body">
                    <div class="container-fluid d-flex justify-content-between header">
                        <div class="col-lg-8 ps-0">
                            <a routerLink="." class="nobleui-logo d-block mt-3">Accident & Incident<span>
                                    Management</span></a>
                            <h6 class=" mb-3 pb-2"># {{Form.value.acc_reference_number}} |
                                {{Form.value.reference_number}}
                            </h6>
                        </div>
                        <!-- <div class="col-lg-4 pe-0">
                            <h6 class="fw-bold text-end mt-4 mb-2">Reporting Date</h6>
                            <h6 class="text-end mb-3 pb-2">21-Sep-2022</h6>
                        </div> -->
                    </div>
                    <div class="container-fluid  justify-content-center w-100">
                        <div class="row">
                            <h4 #default>Corrective / Preventive action</h4>
                            <p class="mb-3">Based on the investigation hereby assigned below mentioned corrective /
                                preventive action.</p>
                        </div>
                        <div class="row">
                            <div class="perfect-scrollbar-example " [perfectScrollbar]>
                                <p [innerHTML]="Form.value.action"></p>
                            </div>
                        </div>
                        <div class="row mt-3 mb-4 text-center" *ngIf="Form.value.status=='In-Progress'">
                            <div class="d-grid gap-2">

                                <button type="button" class="btn btn-secondary" id="ai-suggest"
                                    (click)="checkCorrectiveAction()">AI -
                                    Suggest Action Taken</button>
                                <p class="error hide" id="error-text">Please provide your corrective action in
                                    corrective/preventive action field</p>
                                <button type="button" class="btn btn-success hide" id="ai-loader">
                                    <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                                    Please wait our AI is looking recommendations for action taken.
                                </button>

                            </div>

                        </div>
                        <div class="row mb-4 mt-4" *ngIf="Form.value.status=='In-Progress'">
                            <quill-editor placeholder="Action Taken" [modules]="quillConfig"
                                formControlName="action_taken">
                            </quill-editor>
                        </div>
                        <div class="row mb-4 mt-4" *ngIf="Form.value.status=='In-Progress'">
                            <quill-editor placeholder="User Remarks" [modules]="quillConfig"
                                formControlName="user_remarks">
                            </quill-editor>
                        </div>

                        <div class="row mt-3 " *ngIf="Form.value.status=='In-Progress'">
                            <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                                <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                                    size is less than 20 MB</ngx-dropzone-label>
                                <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                                    *ngFor="let f of files; let i = index" [file]="f" (removed)="onRemove(i)">
                                </ngx-dropzone-image-preview>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <button [disabled]="this.Form.value.action_taken===null" type="button"
                            class="btn btn-success btn-primary btn-icon-text float-end mt-4" (click)="submit()">
                            <i class="feather icon-send btn-icon-prepend"></i>
                            Submit
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card">
                <div class="card-body">
                    <div class="mt-3">
                        <div class="btn-group">
                            <button [disabled]="Form.value.status==='Completed'" type="button"
                                class="btn btn-primary">{{Form.value.status}}</button>
                            <div class="btn-group" ngbDropdown role="group">
                                <button class="btn btn-primary dropdown-toggle-split" ngbDropdownToggle></button>
                                <div ngbDropdownMenu>
                                    <button ngbDropdownItem (click)="inProgress()"
                                        [disabled]="Form.value.status!=='Open'">In-Progress</button>
                                    <button ngbDropdownItem (click)="completed()">Completed</button>
                                </div>
                                <button class="btn btn-success status-btn ms-2" mat-icon-button
                                    aria-label="Example icon-button with a menu" (click)="navigate()">
                                    <i class="feather icon-chevron-left"></i> Back to History

                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3">
                        <mat-form-field appearance="outline" color="primary">
                            <mat-label>Due Date</mat-label>
                            <input matInput [matDatepicker]="duedp" placeholder="Choose a date" [formControl]="dueDate">
                            <mat-datepicker-toggle matSuffix [for]="duedp"></mat-datepicker-toggle>
                            <mat-datepicker #duedp></mat-datepicker>
                            <mat-error>Required Field</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" color="primary">
                            <mat-label>Completed Date</mat-label>
                            <input matInput [matDatepicker]="comdp" placeholder="Choose a date" [formControl]="comDate"
                                (dateChange)="completedDate($event)">
                            <mat-datepicker-toggle matSuffix [for]="comdp"></mat-datepicker-toggle>
                            <mat-datepicker #comdp></mat-datepicker>
                            <mat-error>Required Field</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>