<div mat-dialog-content [formGroup]="Form">
    <div class="container-fluid  d-flex justify-content-center w-100">
        <div class="table-responsive w-100"
            *ngIf="Form?.value?.consumption_category === '' || Form?.value?.consumption_category === null">
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Consumption Category</mat-label>
                        <mat-select formControlName="consumption_category" (selectionChange)="consCategory($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of consumCategory">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source</mat-label>
                        <mat-select formControlName="source" (selectionChange)="sourceVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of source">
                                {{data.attributes.Value}}</mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Quantity</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Unit</mat-label>
                        <input type="text" matInput formControlName="unit">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>

            <div class="row">
                <quill-editor placeholder="Description" [modules]="quillConfig" formControlName="description">
                </quill-editor>
            </div>
            <div class="row mt-3">
                <!-- <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                        size is less than 10 MB</ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                        *ngFor="let f of files" [file]="f" (removed)="onRemove(f)">
                    </ngx-dropzone-image-preview>
                </div> -->
                <div class="custom-dropzone" ngx-dropzone [accept]="'image/*,application/pdf'"
                    (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the evidence size is less than 10
                        MB</ngx-dropzone-label>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-image-preview
                            *ngIf="f.type === 'image/png' || f.type === 'image/jpeg' || f.type === 'image/jpg'"
                            ngProjectAs="ngx-dropzone-preview" [removable]="true" [file]="f" (removed)="onRemove(f)">
                        </ngx-dropzone-image-preview>
                    </ng-container>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-preview *ngIf="f.type === 'application/pdf'" ngProjectAs="ngx-dropzone-preview"
                            [removable]="true" [file]="f" (removed)="onRemove(f)" (click)="openPdf(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ng-container>
                </div>
            </div>
            <div class="mb-3">
                <button type="button" class="btn btn-success btn-icon-text float-end mt-4" [disabled]="!Form.valid"
                    (click)="submit()">
                    <i class="feather icon-send btn-icon-prepend"></i>
                    Save
                </button>
            </div>
        </div>

        <!-- Air Emission -->
        <div class="table-responsive w-100" *ngIf="Form.value.consumption_category==='Air Emission'">
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Consumption Category</mat-label>
                        <mat-select formControlName="consumption_category" (selectionChange)="consCategory($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of consumCategory">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source</mat-label>
                        <mat-select formControlName="source" (selectionChange)="sourceVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of source">
                                {{data.attributes.Value}}</mat-option>
                            <mat-option disabled (click)="new_source()" class="option-btn"> <i
                                    class=" mdi mdi-plus-circle"></i> Add New Source
                            </mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Source Capacity </mat-label>
                        <input type="text" matInput formControlName="source_capacity">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

            </div>
            <!-- <div class="row ">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Pollutants Emitted</mat-label>
                        <mat-select formControlName="pollutants_emitted" (selectionChange)="pollutantsUnitVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of pollutants">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Quantity</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Unit</mat-label>
                        <input type="text" matInput formControlName="unit">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>


            </div> -->


            <div class="row">
                <!-- <div class="col-md-4" *ngIf="Form.value.consumption_category==='Air Emission'">
                    <mat-form-field appearance="outline">
                        <mat-label>Concentration / Year </mat-label>
                        <input type="text" matInput formControlName="concentration">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div> -->
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source Type</mat-label>
                        <mat-select formControlName="source_type">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of source_type">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Determined By</mat-label>
                        <mat-select formControlName="determined_by">
                            <mat-option value="Measured">Measured</mat-option>
                            <mat-option value="Calculated">Calculated</mat-option>

                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="col-md-4 pt-3">
                    <div class="form-check form-switch mb-2">
                        <input type="checkbox" class="form-check-input" id="formSwitch1"
                            formControlName="control_device">
                        <label class="form-check-label" for="formSwitch1">Control Device in Place?</label>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Monitoring Frequency</mat-label>
                        <mat-select formControlName="monitoring_frequency">
                            <mat-option value="Daily">Daily</mat-option>
                            <mat-option value="Weekly">Weekly</mat-option>
                            <mat-option value="Monthly">Monthly</mat-option>
                            <mat-option value="Quarterly">Quarterly</mat-option>
                            <mat-option value="HalfYearly">Half yearly</mat-option>
                            <mat-option value="Annually">Annually</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline" color="primary">
                        <mat-label>Latest Test</mat-label>
                        <input matInput [matDatepicker]="collFromDP" placeholder="Choose a date"
                            [formControl]="latesttest" (dateChange)="latestTest($event)">
                        <mat-datepicker-toggle matSuffix [for]="collFromDP"></mat-datepicker-toggle>
                        <mat-datepicker #collFromDP></mat-datepicker>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Volumetric flow rate (NmÂ³/hr)</mat-label>
                        <input type="number" matInput formControlName="volumetric_flow_rate">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Operation Time (hr)</mat-label>
                        <input type="number" matInput formControlName="operation_time">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Compliance status</mat-label>
                        <mat-select formControlName="compliance_status">
                            <mat-option value="Compliant">Compliant</mat-option>
                            <mat-option value="Non-Compliant">Non-Compliant</mat-option>
                            <mat-option value="Not applicable">Not applicable</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline">
                        <mat-label>Testing Organization</mat-label>
                        <mat-select formControlName="testing_organization">
                            <mat-option *ngFor="let name of TestingOrganization" value="{{name.attributes.name}}">
                                <div class="title-container">
                                    <span> {{name.attributes.name}}</span>
                                    <span class="icon-container"><i class="feather icon-edit titleicon_edit"
                                            (click)="update_testing_organizaton(name.id)"></i> &nbsp;
                                        <i class="feather icon-trash-2 titleicon_delete"
                                            (click)="delete_testing_organization(name.id)"></i>
                                    </span>
                                </div>
                            </mat-option>
                            <mat-option (click)="create_testing_organization()" class="option-btn"> <i
                                    class=" mdi mdi-plus-circle"></i>Add Testing Organization
                            </mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <button type="button" class="btn btn-primary btn-icon-text mb-4" (click)="addPollutantsEmitted()">
                <i class="feather icon-plus btn-icon-prepend"></i>
                Add Pollutants Emitted *
            </button>

            <div class="row mb-2" *ngIf="pollutantsEmitted.length !== 0">
                <div class="pollutants-table-responsive pt-3" id="consumption">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Pollutants Emitted</th>
                                <th>Concentration</th>
                                <th>Unit</th>
                                <th>Legal Emission Limit</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of pollutantsEmitted; let i = index">
                                <td></td>
                                <td>{{ data.pollutants_emitted }}</td>
                                <td>{{ data.quantity }}</td>
                                <td>{{ data.unit }}</td>
                                <td>{{data.legal_emission_limit}}</td>
                                
                                <td>
                                    <button type="button"
                                        class="btn btn-danger btn-icon-text btn-xs action-btn float-start"
                                        (click)="deletePollutantsEmitted(data)">
                                        <i class="feather icon-trash-2"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-primary btn-icon-text btn-xs action-btn float-start"
                                        (click)="editPollutantsEmitted(data, i)">
                                        <i class="feather icon-edit"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="row">
                <quill-editor placeholder="Description" [modules]="quillConfig" formControlName="description">
                </quill-editor>
            </div>
            <div class="row mt-3">
                <!-- <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                        size is less than 10 MB</ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                        *ngFor="let f of files" [file]="f" (removed)="onRemove(f)">
                    </ngx-dropzone-image-preview>
                </div> -->

                <div class="custom-dropzone" ngx-dropzone [accept]="'image/*,application/pdf'"
                    (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the evidence size is less than 10
                        MB</ngx-dropzone-label>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-image-preview
                            *ngIf="f.type === 'image/png' || f.type === 'image/jpeg' || f.type === 'image/jpg'"
                            ngProjectAs="ngx-dropzone-preview" [removable]="true" [file]="f" (removed)="onRemove(f)">
                        </ngx-dropzone-image-preview>
                    </ng-container>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-preview *ngIf="f.type === 'application/pdf'" ngProjectAs="ngx-dropzone-preview"
                            [removable]="true" [file]="f" (removed)="onRemove(f)" (click)="openPdf(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ng-container>
                </div>

            </div>
            <div class="mb-3">
                <button type="button" class="btn btn-success btn-icon-text float-end mt-4"
                    [disabled]="!Form.valid || this.pollutantsEmitted.length === 0" (click)="submit()">
                    <i class="feather icon-send btn-icon-prepend"></i>
                    Save
                </button>
            </div>
        </div>

        <!-- Water -->
        <div class="table-responsive w-100" *ngIf="Form.value.consumption_category==='Water'">
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Consumption Category</mat-label>
                        <mat-select formControlName="consumption_category" (selectionChange)="consCategory($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of consumCategory">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source</mat-label>
                        <mat-select formControlName="source" (selectionChange)="sourceVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of source">
                                {{data.attributes.Value}}</mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Quantity</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input type="number" matInput formControlName="amount">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Unit</mat-label>
                        <input type="text" matInput formControlName="unit">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Meter Reading</mat-label>
                        <input type="number" matInput formControlName="meter_reading">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

            </div>
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Method of Tracking</mat-label>
                        <mat-select formControlName="quantity_source">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of quantities">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Water Type</mat-label>
                        <mat-select formControlName="water_type">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of watertypes">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Applicability</mat-label>
                        <mat-select [formControl]="applicability" multiple (selectionChange)="Applicabilities($event)">
                            <mat-select-trigger>
                                {{applicability.value ? applicability.value[0] : ''}}
                                <span *ngIf="applicability.value?.length > 1" class="example-additional-selection">
                                    (+{{applicability.value.length - 1}}
                                    {{applicability.value?.length === 2 ?
                                    'other' :
                                    'others'}})
                                </span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let data of filteredApplicabilities" [value]="data.attributes.Value">
                                {{data.attributes.Value}}
                            </mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

            </div>
            <div class="row">
                <div class="col-md-4">
                    <!-- <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Usage Type</mat-label>
                        <mat-select formControlName="usage_type" (selectionChange)="UsageType($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of usageTypeList">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field> -->
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Usage Type</mat-label>
                        <mat-select [formControl]="usageType" multiple (selectionChange)="UsageType($event)">
                            <mat-select-trigger>
                                {{usageType.value ? usageType.value[0] : ''}}
                                <span *ngIf="usageType.value?.length > 1" class="example-additional-selection">
                                    (+{{usageType.value.length - 1}}
                                    {{usageType.value?.length === 2 ?
                                    'other' :
                                    'others'}})
                                </span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let data of usageTypeList"
                                [value]="data.attributes.Value">{{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <!-- <div class="row">
                <div class="form-check form-switch mb-3 mx-3">
                    <input type="checkbox" class="form-check-input" id="formSwitch1" formControlName="add_meter">
                    <label class="form-check-label" for="formSwitch1">Add Meter</label>
                </div>
            </div> -->
            <div>

                <button type="button" class="btn btn-primary btn-icon-text mb-4" (click)="addMeter()"
                    [disabled]="!Form.get('unit')?.value">
                    <i class="feather icon-plus btn-icon-prepend"></i>
                    Add Meter
                </button>

            </div>
            <div class="row mb-2" *ngIf="addedMeters.length !== 0">
                <div class="pollutants-table-responsive pt-3" id="consumption">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Meter Name</th>
                                <th>Location</th>
                                <th>Meter Quantity Unit</th>
                                <th>Initial Meter Reading</th>
                                <th>Final Meter Reading</th>
                                <th>Quantity</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of addedMeters; let i = index">
                                <td></td>
                                <td>{{ data.meter_name }}</td>
                                <td>{{ data.location }}</td>
                                <td>{{ data.meter_quantity_unit }}</td>
                                <td>{{ data.initial_meter_reading }}</td>
                                <td>{{ data.final_meter_reading }}</td>
                                <td>{{ data.quantity }}</td>
                                <td>
                                    <button type="button"
                                        class="btn btn-danger btn-icon-text btn-xs action-btn float-start"
                                        (click)="deleteMeter(data,i)">
                                        <i class="feather icon-trash-2"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-primary btn-icon-text btn-xs action-btn float-start"
                                        (click)="editMeter(data, i)">
                                        <i class="feather icon-edit"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <div class="row">
                <quill-editor placeholder="Description" [modules]="quillConfig" formControlName="description">
                </quill-editor>
            </div>
            <div class="row mt-3">
                <!-- <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                        size is less than 10 MB</ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                        *ngFor="let f of files" [file]="f" (removed)="onRemove(f)">
                    </ngx-dropzone-image-preview>
                </div> -->
                <div class="custom-dropzone" ngx-dropzone [accept]="'image/*,application/pdf'"
                    (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the evidence size is less than 10
                        MB</ngx-dropzone-label>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-image-preview
                            *ngIf="f.type === 'image/png' || f.type === 'image/jpeg' || f.type === 'image/jpg'"
                            ngProjectAs="ngx-dropzone-preview" [removable]="true" [file]="f" (removed)="onRemove(f)">
                        </ngx-dropzone-image-preview>
                    </ng-container>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-preview *ngIf="f.type === 'application/pdf'" ngProjectAs="ngx-dropzone-preview"
                            [removable]="true" [file]="f" (removed)="onRemove(f)" (click)="openPdf(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ng-container>
                </div>
            </div>
            <div class="mb-3">
                <button type="button" class="btn btn-primary btn-icon-text float-end mt-4" [disabled]="!Form.valid"
                    (click)="submitAndNew()">
                    <i class="feather icon-plus-circle btn-icon-prepend"></i>
                    Save And New
                </button>
                <button type="button" class="btn btn-success btn-icon-text float-end mt-4  action-btn"
                    [disabled]="!Form.valid" (click)="submit()">
                    <i class="feather icon-send btn-icon-prepend"></i>
                    Save
                </button>
            </div>
        </div>

        <!-- Waste -->
        <div class="table-responsive w-100" *ngIf="Form.value.consumption_category==='Waste'">
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Consumption Category</mat-label>
                        <mat-select formControlName="consumption_category" (selectionChange)="consCategory($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of consumCategory">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Waste Type</mat-label>
                        <mat-select formControlName="waste_type" (selectionChange)="ChangeWasteType($event)">
                            <mat-option value="{{data.attributes.type}}" *ngFor="let data of wasteTypes">
                                {{data.attributes.type}}</mat-option>
                            <mat-option disabled (click)="new_waste_type()" class="option-btn"> <i
                                    class=" mdi mdi-plus-circle"></i> Add New Waste Type
                            </mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source</mat-label>
                        <mat-select formControlName="source" (selectionChange)="sourceVal($event)">
                            <mat-option value="{{data?.attributes?.Value}}" *ngFor="let data of source">
                                {{data.attributes.Value}}</mat-option>
                            <mat-option disabled (click)="new_source()" class="option-btn"  *ngIf="Form.value.waste_type"> <i
                                    class=" mdi mdi-plus-circle"></i> Add New Source
                            </mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Quantity</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input type="number" matInput formControlName="amount">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Unit</mat-label>
                        <input type="text" matInput formControlName="unit">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Category</mat-label>
                        <input type="text" matInput formControlName="category" >
                      </mat-form-field>
                    <!-- <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Category</mat-label>
                        <mat-select formControlName="category">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of categories">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field> -->
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline" color="primary">
                        <mat-label>Collected From</mat-label>
                        <input matInput [matDatepicker]="collFromDP" placeholder="Choose a date"
                            [formControl]="collectedFrom" (dateChange)="collFrom($event)">
                        <mat-datepicker-toggle matSuffix [for]="collFromDP"></mat-datepicker-toggle>
                        <mat-datepicker #collFromDP></mat-datepicker>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline" color="primary">
                        <mat-label>Collected to</mat-label>
                        <input matInput [matDatepicker]="colledtToDP" placeholder="Choose a date"
                            [formControl]="collectedTo" (dateChange)="collTo($event)">
                        <mat-datepicker-toggle matSuffix [for]="colledtToDP"></mat-datepicker-toggle>
                        <mat-datepicker #colledtToDP></mat-datepicker>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Disposal Method</mat-label>
                        <mat-select formControlName="disposal_method">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of disposalMethod">
                                {{data.attributes.Value}}</mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Consignment Number</mat-label>
                        <input type="text" matInput formControlName="consignment_number">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline" color="primary">
                        <mat-label>Disposal Date</mat-label>
                        <input matInput [matDatepicker]="diposalDP" placeholder="Choose a date"
                            [formControl]="disposalDate" (dateChange)="disDate($event)">
                        <mat-datepicker-toggle matSuffix [for]="diposalDP"></mat-datepicker-toggle>
                        <mat-datepicker #diposalDP></mat-datepicker>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Disposer</mat-label>
                        <input type="text" matInput formControlName="disposer">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Carrier</mat-label>
                        <input type="text" matInput formControlName="carrier">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Place of Disposal</mat-label>
                        <input type="text" matInput formControlName="disposal_place">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="col-md-4"
                    *ngIf="Form.value.consumption_category==='Waste'&&Form.value.source==='Waste Water Sludge'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Method of Tracking</mat-label>
                        <mat-select formControlName="quantity_source">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of wasteQuantities">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            <div class="row">
                <quill-editor placeholder="Description" [modules]="quillConfig" formControlName="description">
                </quill-editor>
            </div>
            <div class="row mt-3">
                <!-- <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                        size is less than 10 MB</ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                        *ngFor="let f of files" [file]="f" (removed)="onRemove(f)">
                    </ngx-dropzone-image-preview>
                </div> -->
                <div class="custom-dropzone" ngx-dropzone [accept]="'image/*,application/pdf'"
                    (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the evidence size is less than 10
                        MB</ngx-dropzone-label>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-image-preview
                            *ngIf="f.type === 'image/png' || f.type === 'image/jpeg' || f.type === 'image/jpg'"
                            ngProjectAs="ngx-dropzone-preview" [removable]="true" [file]="f" (removed)="onRemove(f)">
                        </ngx-dropzone-image-preview>
                    </ng-container>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-preview *ngIf="f.type === 'application/pdf'" ngProjectAs="ngx-dropzone-preview"
                            [removable]="true" [file]="f" (removed)="onRemove(f)" (click)="openPdf(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ng-container>
                </div>
            </div>
            <div class="mb-3">
                <button type="button" class="btn btn-primary btn-icon-text float-end mt-4 " [disabled]="!Form.valid"
                    (click)="submitAndNew()">
                    <i class="feather icon-plus-circle btn-icon-prepend"></i>
                    Save And New
                </button>
                <button type="button" class="btn btn-success btn-icon-text float-end mt-4  action-btn"
                    [disabled]="!Form.valid" (click)="submit()">
                    <i class="feather icon-send btn-icon-prepend"></i>
                    Save
                </button>
            </div>
        </div>

        <!--Wastewater -->
        <div class="table-responsive w-100" *ngIf="Form.value.consumption_category==='Wastewater'">
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Consumption Category</mat-label>
                        <mat-select formControlName="consumption_category" (selectionChange)="consCategory($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of consumCategory">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source</mat-label>
                        <mat-select formControlName="source" (selectionChange)="sourceVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of source">
                                {{data.attributes.Value}}</mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Quantity</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input type="number" matInput formControlName="amount">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Unit</mat-label>
                        <input type="text" matInput formControlName="unit">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Treatment Where</mat-label>
                        <mat-select formControlName="treatment">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of treatment">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Method of Tracking</mat-label>
                        <mat-select formControlName="quantity_source">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of quantities">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source==='Industrial' || Form.value.source==='Domestic'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Applicability</mat-label>
                        <mat-select [formControl]="applicability" multiple (selectionChange)="Applicabilities($event)">
                            <mat-select-trigger>
                                {{applicability.value ? applicability.value[0] : ''}}
                                <span *ngIf="applicability.value?.length > 1" class="example-additional-selection">
                                    (+{{applicability.value.length - 1}}
                                    {{applicability.value?.length === 2 ?
                                    'other' :
                                    'others'}})
                                </span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let data of applicabilities" [value]="data.attributes.Value">
                                {{data.attributes.Value}}
                            </mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source==='Industrial' || Form.value.source==='Domestic'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Treatment Outcome</mat-label>
                        <!-- <mat-select formControlName="treatment_outcome"multiple>
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of treatmentOutcomes">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select> -->
                        <mat-select [formControl]="Treatment_outcome_Quantity" multiple
                            (selectionChange)="TreatmentOutcome($event)">
                            <mat-select-trigger>
                                {{Treatment_outcome_Quantity.value ? Treatment_outcome_Quantity.value[0] : ''}}
                                <span *ngIf="Treatment_outcome_Quantity.value?.length > 1"
                                    class="example-additional-selection">
                                    (+{{Treatment_outcome_Quantity.value.length - 1}}
                                    {{Treatment_outcome_Quantity.value?.length === 2 ?
                                    'other' :
                                    'others'}})
                                </span>
                            </mat-select-trigger>

                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of treatmentOutcomes">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>


            </div>
            <div class="row" *ngIf="Form.value.source==='Industrial' || Form.value.source==='Domestic'">
                <div class="col-md-4" *ngIf="showField('Others')">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Treatment Outcome Quantity</mat-label>
                        <input type="number" matInput formControlName="reused_recycled_quantity">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="showField('Recycled')">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Treatment Outcome - Recycled</mat-label>
                        <input type="number" matInput formControlName="treatment_outcome_recycled">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="showField('Reused')">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Treatment Outcome - Reused</mat-label>
                        <input type="number" matInput formControlName="treatment_outcome_reused">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
            </div>


            <div class="row">
                <quill-editor placeholder="Description" [modules]="quillConfig" formControlName="description">
                </quill-editor>
            </div>
            <div class="row mt-3">
                <!-- <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                        size is less than 10 MB</ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                        *ngFor="let f of files" [file]="f" (removed)="onRemove(f)">
                    </ngx-dropzone-image-preview>
                </div> -->
                <div class="custom-dropzone" ngx-dropzone [accept]="'image/*,application/pdf'"
                    (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the evidence size is less than 10
                        MB</ngx-dropzone-label>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-image-preview
                            *ngIf="f.type === 'image/png' || f.type === 'image/jpeg' || f.type === 'image/jpg'"
                            ngProjectAs="ngx-dropzone-preview" [removable]="true" [file]="f" (removed)="onRemove(f)">
                        </ngx-dropzone-image-preview>
                    </ng-container>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-preview *ngIf="f.type === 'application/pdf'" ngProjectAs="ngx-dropzone-preview"
                            [removable]="true" [file]="f" (removed)="onRemove(f)" (click)="openPdf(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ng-container>
                </div>
            </div>
            <div class="mb-3">
                <button type="button" class="btn btn-primary btn-icon-text float-end mt-4 " [disabled]="!Form.valid"
                    (click)="submitAndNew()">
                    <i class="feather icon-plus-circle btn-icon-prepend"></i>
                    Save And New
                </button>
                <button type="button" class="btn btn-success btn-icon-text float-end mt-4  action-btn"
                    [disabled]="!Form.valid" (click)="submit()">
                    <i class="feather icon-send btn-icon-prepend"></i>
                    Save
                </button>
            </div>
        </div>

        <!-- Energy -->
        <div class="table-responsive w-100" *ngIf="Form.value.consumption_category==='Energy'">
            <div class="row ">
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Consumption Category</mat-label>
                        <mat-select formControlName="consumption_category" (selectionChange)="consCategory($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of consumCategory">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Source</mat-label>
                        <mat-select formControlName="source" (selectionChange)="sourceVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of source">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source!=='Refrigerants'">
                    <mat-form-field appearance="outline">
                        <mat-label>Quantity</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <!-- <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Refrigerant Type</mat-label>
                        <mat-select formControlName="refrigerant_type" (selectionChange)="refrigerantVal($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of refrigerantTypes">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field> -->
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Refrigerant Type</mat-label>
                        <input type="text" matInput [formControl]="refrigerantType" [matAutocomplete]="auto">
                        <mat-autocomplete #auto="matAutocomplete"
                            (optionSelected)="refrigerantVal($event.option.value)">
                            <mat-option *ngFor="let option of filteredRefrigerantOptions | async" [value]="option">
                                {{option}}
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>

            </div>
            <div class="row ">
                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <mat-form-field appearance="outline">
                        <mat-label>Usage</mat-label>
                        <input type="number" matInput formControlName="quantity" (change)="kwhQuantity($event)">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>

                </div>
                <div class="col-md-4" *ngIf="Form.value.consumption_category!=='Air Emission'">
                    <mat-form-field appearance="outline">
                        <mat-label>Amount</mat-label>
                        <input type="number" matInput formControlName="amount">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <mat-form-field appearance="outline">
                        <mat-label>Unit</mat-label>
                        <input type="text" matInput formControlName="unit">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source!=='Refrigerants'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Scope</mat-label>
                        <mat-select formControlName="scope">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of scopes">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

            </div>
            <div class="row">
                <div class="col-md-4" *ngIf="Form.value.source ==='Refrigerants'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Scope</mat-label>
                        <mat-select formControlName="scope">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of scopes">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.scope ==='Scope-1'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Scope 1 Category</mat-label>
                        <mat-select formControlName="scope_1_cateogry">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of scopes1categories">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source==='Electricity' ">
                    <mat-form-field appearance="outline">
                        <mat-label>Meter Reading</mat-label>
                        <input type="number" matInput formControlName="meter_reading">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

                <div class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Method of Tracking</mat-label>
                        <mat-select formControlName="quantity_source">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of quantities">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4">
                    <!-- <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Usage Type</mat-label>
                        <mat-select formControlName="usage_type" (selectionChange)="UsageType($event)">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of usageTypeList">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field> -->
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Usage Type</mat-label>
                        <mat-select [formControl]="usageType" multiple (selectionChange)="UsageType($event)">
                            <mat-select-trigger>
                                {{usageType.value ? usageType.value[0] : ''}}
                                <span *ngIf="usageType.value?.length > 1" class="example-additional-selection">
                                    (+{{usageType.value.length - 1}}
                                    {{usageType.value?.length === 2 ?
                                    'other' :
                                    'others'}})
                                </span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let data of usageTypeList"
                                [value]="data.attributes.Value">{{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>

                </div>
                <div class="col-md-4 special-field" *ngIf="Form.value.source==='Purchased Electricity'">
                    <div class="form-check form-switch mb-2">
                        <input type="checkbox" class="form-check-input" id="formSwitch1" formControlName="rec_status"
                            (ngModelChange)="onRecStatusChange($event)">
                        <label class="form-check-label" for="formSwitch1">Do you have REC?</label>
                    </div>
                </div>
                <div class="col-md-4" *ngIf="Form.value.rec_status === true">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>REC Type</mat-label>
                        <mat-select formControlName="rec_type">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of recDataList">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

                <div *ngIf="renewable===true" class="col-md-4">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Renewable Energy Source</mat-label>
                        <mat-select formControlName="renewable_energy_source">
                            <mat-option value="{{data.attributes.Value}}" *ngFor="let data of renewableEnergySources">
                                {{data.attributes.Value}}</mat-option>
                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>

                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <mat-form-field appearance="outline">
                        <mat-label>Opening Balance</mat-label>
                        <input type="number" matInput formControlName="opening_balance">
                        <!-- <mat-error>Required Field</mat-error> -->
                    </mat-form-field>
                </div>

                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <mat-form-field appearance="outline">
                        <mat-label>Purchased Quantity</mat-label>
                        <input type="number" matInput formControlName="purchased_quantity">
                        <!-- <mat-error>Required Field</mat-error> -->
                    </mat-form-field>
                </div>

                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <mat-form-field appearance="outline">
                        <mat-label>Purchase Date</mat-label>
                        <input matInput [matDatepicker]="collFromDP" placeholder="Choose a date"
                            formControlName="purchase_date">
                        <mat-datepicker-toggle matSuffix [for]="collFromDP"></mat-datepicker-toggle>
                        <mat-datepicker #collFromDP></mat-datepicker>
                        <!-- <mat-error>Required Field</mat-error> -->
                    </mat-form-field>
                </div>

                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <mat-form-field fxFlex appearance="outline">
                        <mat-label>Supplier Name</mat-label>
                        <mat-select formControlName="supplier_name">
                            <mat-option *ngFor="let name of supplierList" value="{{name.attributes.name}}">
                                {{name.attributes.name}}</mat-option>
                            <mat-option (click)="create_supplier()" class="option-btn"> <i
                                    class=" mdi mdi-plus-circle"></i> Create a new Supplier
                            </mat-option>
                        </mat-select>
                        <!-- <mat-error>Required Field</mat-error> -->
                    </mat-form-field>
                </div>

                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <mat-form-field appearance="outline">
                        <mat-label>Stock Balance</mat-label>
                        <input type="number" matInput formControlName="stock_balance">
                        <!-- <mat-error>Required Field</mat-error> -->
                    </mat-form-field>
                </div>

                <div class="col-md-4" *ngIf="Form.value.source==='Refrigerants'">
                    <div class="form-check form-switch mb-3 mx-3">
                        <input type="checkbox" class="form-check-input" id="formSwitch1" formControlName="add_issue">
                        <label class="form-check-label" for="formSwitch1">Add Issue</label>
                    </div>
                </div>

                <!-- <div class="col-md-4">
                    <div class="form-check form-switch mb-3 mx-3">
                        <input type="checkbox" class="form-check-input" id="formSwitch1" formControlName="add_meter">
                        <label class="form-check-label" for="formSwitch1">Add Meter</label>
                    </div>
                </div> -->

            </div>
            <div class="row">
                <div class="col-md-4" *ngIf="Form.value.rec_type === 'I-REC'">
                    <mat-form-field appearance="outline">
                        <mat-label>I-REC Quantity</mat-label>
                        <input type="number" matInput formControlName="i_rec_quantity">
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>
                <div class="col-md-4" *ngIf="Form.value.source==='Industrial' || Form.value.source==='Domestic'">
                    <mat-form-field fxFlex appearance="outline" color="primary">
                        <mat-label>Applicability</mat-label>
                        <mat-select [formControl]="applicability" multiple (selectionChange)="Applicabilities($event)">
                            <mat-select-trigger>
                                {{applicability.value ? applicability.value[0] : ''}}
                                <span *ngIf="applicability.value?.length > 1" class="example-additional-selection">
                                    (+{{applicability.value.length - 1}}
                                    {{applicability.value?.length === 2 ?
                                    'other' :
                                    'others'}})
                                </span>
                            </mat-select-trigger>
                            <mat-option *ngFor="let data of applicabilities" [value]="data.attributes.Value">
                                {{data.attributes.Value}}
                            </mat-option>

                        </mat-select>
                        <mat-error>Required Field</mat-error>
                    </mat-form-field>
                </div>


            </div>


            <div>

                <button type="button" class="btn btn-primary btn-icon-text mb-4" (click)="addMeter()"
                    [disabled]="!Form.get('unit')?.value">
                    <i class="feather icon-plus btn-icon-prepend"></i>
                    Add Meter
                </button>

            </div>
            <div class="row mb-2" *ngIf="addedMeters.length !== 0">
                <div class="pollutants-table-responsive pt-3" id="consumption">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Meter Name</th>
                                <th>Location</th>
                                <th>Meter Quantity Unit</th>
                                <th>Initial Meter Reading</th>
                                <th>Final Meter Reading</th>
                                <th>Quantity</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of addedMeters; let i = index">
                                <td></td>
                                <td>{{ data.meter_name }}</td>
                                <td>{{ data.location }}</td>
                                <td>{{ data.meter_quantity_unit }}</td>
                                <td>{{ data.initial_meter_reading }}</td>
                                <td>{{ data.final_meter_reading }}</td>
                                <td>{{ data.quantity }}</td>
                                <td>
                                    <button type="button"
                                        class="btn btn-danger btn-icon-text btn-xs action-btn float-start"
                                        (click)="deleteMeter(data,i)">
                                        <i class="feather icon-trash-2"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-primary btn-icon-text btn-xs action-btn float-start"
                                        (click)="editMeter(data, i)">
                                        <i class="feather icon-edit"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="row mt-3" *ngIf="Form.value.source==='Refrigerants' && Form.value.add_issue === true">
                <button type="button" class="btn btn-primary btn-icon-text" (click)="add_issue()">
                    Add Issue
                    <i class="feather icon-box btn-icon-append"></i>
                </button>
            </div>
            <div class="row mb-3" *ngIf="Form.value.source==='Refrigerants' && Form.value.add_issue === true">
                <div class="table-responsive pt-3" id="refrigerant">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Issued Date</th>
                                <th>Issued Quantity</th>
                                <th>Unit</th>
                                <th>Issued To</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of IssueList; let i = index">
                                <td></td>
                                <td>{{data.issued_date | date:'MMM d, y'}}</td>
                                <td>{{data.issued_quantity}}</td>
                                <td>{{data.unit}}</td>
                                <td>{{data.issued_to}}</td>
                                <td>
                                    <button type="button"
                                        class="btn btn-danger btn-icon-text btn-xs action-btn float-start"
                                        (click)="deleteIssue(i)">
                                        <i class="feather icon-trash-2"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-primary btn-icon-text btn-xs action-btn float-start"
                                        (click)="viewIssue(data)">
                                        <i class="feather icon-eye"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-warning btn-icon-text btn-xs action-btn float-start"
                                        (click)="editIssue(data, i)">
                                        <i class="feather icon-edit"></i>
                                    </button>

                                </td>
                            </tr>
                        </tbody>

                    </table>
                </div>
            </div>

            <div class="row mt-3" *ngIf="Form.value.source==='Refrigerants'">
                <button type="button" class="btn btn-primary btn-icon-text" (click)="addRefrigerant()">
                    Add Refrigerant Usage
                    <i class="feather icon-box btn-icon-append"></i>
                </button>
            </div>
            <div class="row mb-3" *ngIf="Form.value.source==='Refrigerants'">
                <div class="table-responsive pt-3" id="refrigerant">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Equipment Name</th>
                                <th>Quantity of refrigerant refill</th>
                                <th>Unit</th>
                                <th>Refill Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of refrigerants; let i = index">
                                <td></td>
                                <td>{{data.equipment_name}}</td>
                                <td>{{data.quantity}}</td>
                                <td>{{data.unit}}</td>
                                <td>{{data.refill_date | date:'MMM d, y'}}</td>
                                <td>
                                    <button type="button"
                                        class="btn btn-danger btn-icon-text btn-xs action-btn float-start"
                                        (click)="deleteRefrigerant(i)">
                                        <i class="feather icon-trash-2"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-primary btn-icon-text btn-xs action-btn float-start"
                                        (click)="viewRefrigerant(data)">
                                        <i class="feather icon-eye"></i>
                                    </button>

                                    <button type="button"
                                        class="btn btn-warning btn-icon-text btn-xs action-btn float-start"
                                        (click)="editRefrigerant(data, i)">
                                        <i class="feather icon-edit"></i>
                                    </button>

                                </td>
                            </tr>
                        </tbody>

                    </table>
                </div>
            </div>




            <div class="row">
                <quill-editor placeholder="Description" [modules]="quillConfig" formControlName="description">
                </quill-editor>
            </div>
            <div class="row mt-3">
                <!-- <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the image
                        size is less than 10 MB</ngx-dropzone-label>
                    <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" [removable]="true"
                        *ngFor="let f of files" [file]="f" (removed)="onRemove(f)">
                    </ngx-dropzone-image-preview>
                </div> -->
                <div class="custom-dropzone" ngx-dropzone [accept]="'image/*,application/pdf'"
                    (change)="onSelect($event)">
                    <ngx-dropzone-label>Drop your evidences here. Please ensure the evidence size is less than 10
                        MB</ngx-dropzone-label>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-image-preview
                            *ngIf="f.type === 'image/png' || f.type === 'image/jpeg' || f.type === 'image/jpg'"
                            ngProjectAs="ngx-dropzone-preview" [removable]="true" [file]="f" (removed)="onRemove(f)">
                        </ngx-dropzone-image-preview>
                    </ng-container>


                    <ng-container *ngFor="let f of files">
                        <ngx-dropzone-preview *ngIf="f.type === 'application/pdf'" ngProjectAs="ngx-dropzone-preview"
                            [removable]="true" [file]="f" (removed)="onRemove(f)" (click)="openPdf(f)">
                            <ngx-dropzone-label>{{ f.name }} ({{ f.type }})</ngx-dropzone-label>
                        </ngx-dropzone-preview>
                    </ng-container>
                </div>
            </div>


            <div class="mb-3">
                <button type="button" class="btn btn-primary btn-icon-text float-end mt-4" [disabled]="!Form.valid"
                    (click)="submitAndNew()">
                    <i class="feather icon-plus-circle btn-icon-prepend"></i>
                    Save And New
                </button>
                <button type="button" class="btn btn-success btn-icon-text float-end mt-4  action-btn"
                    [disabled]="!Form.valid" (click)="submit()">
                    <i class="feather icon-send btn-icon-prepend"></i>
                    Save
                </button>
            </div>
        </div>

    </div>
</div>